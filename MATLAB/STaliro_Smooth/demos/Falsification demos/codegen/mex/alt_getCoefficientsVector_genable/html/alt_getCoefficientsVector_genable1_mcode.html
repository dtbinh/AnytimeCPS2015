<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">C_00k</span>,<span class="var type1" id="S3T2U4">D_ejk</span>] = alt_getCoefficientsVector_genable(<span class="var type1" id="S4T3U7">grid_x</span>,<span class="var type1" id="S5T4U8">dist_array_xy</span>,<span class="var type1" id="S6T5U9">dx</span>,<span class="var type1" id="S7T5U10">j_min</span>,<span class="var type1" id="S8T5U11">j_max</span>,<span class="var type1" id="S9T5U12">k_min</span>,<span class="var type1" id="S10T5U13">k_max</span>,<span class="var type1" id="S11T4U14">E_dash</span>,<span class="var type1" id="S12T5U15">viz</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%see Nonlinear Approximation, R. A. DeVore, Acta Numerica 1998, Cambridge</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%University Press</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T4:U12"><span class="var type1" id="S13T4U18">E</span> = <span class="mxinfo " id="T4:U14"><span class="var type1" id="S11T4U20">E_dash</span>(<span class="mxinfo " id="T6:U16"><span class="mxinfo " id="T5:U17">2</span>:<span class="mxinfo " id="T5:U18">end</span></span>,<span class="mxinfo " id="T7:U19">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T5:U20"><span class="var type1" id="S15T5U28">dim</span> = <span class="mxinfo " id="T5:U22">log2(<span class="mxinfo " id="T5:U23"><span class="mxinfo " id="T5:U24">size(<span class="var type1" id="S13T4U34">E</span>,1)</span>+<span class="mxinfo " id="T5:U26">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T4:U27"><span class="var type1" id="S18T4U39">K</span> = <span class="mxinfo " id="T4:U29">zeros(<span class="mxinfo " id="T5:U30">(<span class="mxinfo " id="T5:U31">numel(<span class="mxinfo " id="T3:U32"><span class="var type1" id="S9T5U47">k_min</span>:<span class="var type1" id="S10T5U48">k_max</span></span>)</span>)^<span class="var type1" id="S15T5U49">dim</span></span>,<span class="var type1" id="S15T5U50">dim</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S21T5U53">i</span> = <span class="mxinfo " id="T5:U38">1</span>:<span class="mxinfo " id="T5:U39">(<span class="mxinfo " id="T5:U40">numel(<span class="mxinfo " id="T3:U41"><span class="var type1" id="S9T5U61">k_min</span>:<span class="var type1" id="S10T5U62">k_max</span></span>)</span>)^<span class="var type1" id="S15T5U63">dim</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">   <span class="mxinfo " id="T3:U45"><span class="mxinfo " id="T3:U46"><span class="var type1" id="S18T4U67">K</span>(<span class="var type1" id="S21T5U68">i</span>,<span class="mxinfo " id="T7:U49">:</span>)</span> = <span class="mxinfo " id="T3:U50"><span class="fcn" id="F204N6:B71">permn2</span>(<span class="mxinfo " id="T3:U51"><span class="var type1" id="S9T5U73">k_min</span>:<span class="var type1" id="S10T5U74">k_max</span></span>,<span class="var type1" id="S15T5U75">dim</span>,<span class="var type1" id="S21T5U76">i</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"><span class="comment">%K = permn(k_min:k_max,dim);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T5:U56"><span class="var type1" id="S23T5U79">k_sz</span> = <span class="mxinfo " id="T5:U58">size(<span class="var type1" id="S18T4U82">K</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T4:U60"><span class="var type1" id="S24T4U86">X</span> = <span class="mxinfo " id="T4:U62">zeros(<span class="mxinfo " id="T5:U63"><span class="mxinfo " id="T5:U64">numel(<span class="var type1" id="S4T3U92">grid_x</span>)</span>^<span class="var type1" id="S15T5U93">dim</span></span>,<span class="var type1" id="S15T5U94">dim</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S21T5U97">i</span> = <span class="mxinfo " id="T5:U69">1</span>:<span class="mxinfo " id="T5:U70">(<span class="mxinfo " id="T5:U71">numel(<span class="var type1" id="S4T3U104">grid_x</span>)</span>)^<span class="var type1" id="S15T5U105">dim</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line">   <span class="mxinfo " id="T3:U74"><span class="mxinfo " id="T3:U75"><span class="var type1" id="S24T4U109">X</span>(<span class="var type1" id="S21T5U110">i</span>,<span class="mxinfo " id="T7:U78">:</span>)</span> = <span class="mxinfo " id="T3:U79"><span class="fcn" id="F204N6:B113">permn2</span>(<span class="var type1" id="S4T3U114">grid_x</span>,<span class="var type1" id="S15T5U115">dim</span>,<span class="var type1" id="S21T5U116">i</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="comment">%X = permn(grid_x,dim);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T5:U83"><span class="var type1" id="S25T5U119">x_sz</span> = <span class="mxinfo " id="T5:U85">size(<span class="var type1" id="S24T4U122">X</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T5:U87"><span class="var type1" id="S26T5U126">j_sz</span> = <span class="mxinfo " id="T5:U89">numel(<span class="mxinfo " id="T3:U90"><span class="var type1" id="S7T5U130">j_min</span>:<span class="var type1" id="S8T5U131">j_max</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo " id="T2:U93"><span class="var type1" id="S3T2U134">D_ejk</span> = <span class="mxinfo " id="T2:U95">zeros(<span class="mxinfo " id="T5:U96">size(<span class="var type1" id="S11T4U139">E_dash</span>,1)</span>,<span class="var type1" id="S26T5U141">j_sz</span>,<span class="var type1" id="S23T5U142">k_sz</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line"><span class="mxinfo " id="T1:U100"><span class="var type1" id="S2T1U145">C_00k</span> = <span class="mxinfo " id="T1:U102">zeros(<span class="mxinfo " id="T5:U103">1</span>,<span class="mxinfo " id="T5:U104">1</span>,<span class="var type1" id="S23T5U150">k_sz</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line"><span class="mxinfo " id="T3:U106"><span class="var type1" id="S27T3U153">phis</span> = <span class="mxinfo " id="T3:U108">zeros(<span class="mxinfo " id="T5:U109">1</span>,<span class="var type1" id="S15T5U157">dim</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo " id="T3:U111"><span class="var type1" id="S28T3U160">psis</span> = <span class="mxinfo " id="T3:U113">zeros(<span class="mxinfo " id="T5:U114">1</span>,<span class="var type1" id="S15T5U164">dim</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line"><span class="comment">%compute C_00k</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S29T5U167">k_dims</span> = <span class="mxinfo " id="T5:U117">1</span>:<span class="var type1" id="S23T5U170">k_sz</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line">    <span class="mxinfo " id="T5:U119"><span class="var type1" id="S30T5U173">summation_C</span> = <span class="mxinfo " id="T5:U121">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S31T5U177">x_dims</span> = <span class="mxinfo " id="T5:U123">1</span>:<span class="var type1" id="S25T5U180">x_sz</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line">        <span class="mxinfo " id="T8:U125"><span class="var type1" id="S32T8U183">x</span> = <span class="mxinfo " id="T8:U127"><span class="mxinfo " id="T8:U128">(<span class="mxinfo " id="T5:U129">2^0</span>)*<span class="mxinfo " id="T8:U130"><span class="mxinfo " id="T3:U131"><span class="var type1" id="S24T4U192">X</span>(<span class="var type1" id="S31T5U193">x_dims</span>,<span class="mxinfo " id="T7:U134">:</span>)</span>'</span></span> - <span class="mxinfo " id="T8:U135"><span class="mxinfo " id="T3:U136"><span class="var type1" id="S18T4U197">K</span>(<span class="var type1" id="S29T5U198">k_dims</span>,<span class="mxinfo " id="T7:U139">:</span>)</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37">37</a></span><span class="line">        [<span class="mxinfo " id="T5:U140"><span class="var type1" id="S29T5U204">k_dims</span>/<span class="var type1" id="S23T5U205">k_sz</span></span> <span class="mxinfo " id="T5:U143"><span class="var type1" id="S31T5U207">x_dims</span>/<span class="var type1" id="S25T5U208">x_sz</span></span>];</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38">38</a></span><span class="line">        <span class="comment">%[phis,~] = arrayfun(@(t) MeyerWavelet(t),x);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39">39</a></span><span class="line">        <span class="comment">%phis = (2^0)*phis';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40">40</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41">41</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42">42</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S33T5U211">dimen</span> = <span class="mxinfo " id="T5:U147">1</span>:<span class="var type1" id="S15T5U214">dim</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43">43</a></span><span class="line">           <span class="mxinfo " id="T5:U149"><span class="mxinfo " id="T5:U150"><span class="var type1" id="S27T3U218">phis</span>(<span class="var type1" id="S33T5U219">dimen</span>)</span> = <span class="mxinfo " id="T5:U153">(<span class="mxinfo " id="T5:U154"><span class="mxinfo " id="T5:U155">2</span>^0</span>)*<span class="mxinfo " id="T5:U156"><span class="fcn" id="F233N2:B226">MeyerWavelet</span>(<span class="mxinfo " id="T5:U157"><span class="var type1" id="S32T8U228">x</span>(<span class="var type1" id="S33T5U229">dimen</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44">44</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45">45</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46">46</a></span><span class="line">        <span class="mxinfo " id="T5:U160"><span class="var type1" id="S35T5U232">bigPhi_00k_x</span> = <span class="mxinfo " id="T5:U162">prod(<span class="var type1" id="S27T3U235">phis</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47">47</a></span><span class="line">        <span class="mxinfo " id="T5:U164"><span class="var type1" id="S37T5U238">g_x</span> = <span class="mxinfo " id="T5:U166"><span class="var type1" id="S5T4U240">dist_array_xy</span>(<span class="var type1" id="S31T5U241">x_dims</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48">48</a></span><span class="line">        <span class="mxinfo " id="T5:U169"><span class="var type1" id="S30T5U244">summation_C</span> = <span class="mxinfo " id="T5:U171"><span class="var type1" id="S30T5U246">summation_C</span> + <span class="mxinfo " id="T5:U173"><span class="mxinfo " id="T5:U174">(<span class="mxinfo " id="T5:U175"><span class="var type1" id="S6T5U251">dx</span>^<span class="var type1" id="S15T5U252">dim</span></span>)*<span class="var type1" id="S37T5U253">g_x</span></span>*<span class="var type1" id="S35T5U254">bigPhi_00k_x</span></span></span></span>; <span class="comment">%check use of dim and dx here</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49">49</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50">50</a></span><span class="line">    <span class="mxinfo " id="T5:U180"><span class="mxinfo " id="T5:U181"><span class="var type1" id="S2T1U258">C_00k</span>(<span class="mxinfo " id="T5:U183">1</span>,<span class="mxinfo " id="T5:U184">1</span>,<span class="var type1" id="S29T5U261">k_dims</span>)</span> = <span class="var type1" id="S30T5U262">summation_C</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51">51</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52">52</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53">53</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S38T5U265">e</span> = <span class="mxinfo " id="T5:U188">1</span>:<span class="mxinfo " id="T5:U189">size(<span class="var type1" id="S13T4U270">E</span>,1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54">54</a></span><span class="line">    <span class="mxinfo " id="T5:U191"><span class="var type1" id="S39T5U274">j_ix</span> = <span class="mxinfo " id="T5:U193">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55">55</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S40T5U278">j</span>=<span class="var type1" id="S7T5U281">j_min</span>:<span class="mxinfo " id="T5:U196">1</span>:<span class="var type1" id="S8T5U283">j_max</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56">56</a></span><span class="line">        <span class="mxinfo " id="T5:U198"><span class="var type1" id="S39T5U286">j_ix</span> = <span class="mxinfo " id="T5:U200"><span class="var type1" id="S39T5U288">j_ix</span> + <span class="mxinfo " id="T5:U202">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57">57</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S29T5U292">k_dims</span> = <span class="mxinfo " id="T5:U204">1</span>:<span class="var type1" id="S23T5U295">k_sz</span> <span class="comment">%k along each dim</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58">58</a></span><span class="line">            <span class="mxinfo " id="T5:U206"><span class="var type1" id="S41T5U298">summation_D</span> = <span class="mxinfo " id="T5:U208">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59">59</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S31T5U302">x_dims</span> = <span class="mxinfo " id="T5:U210">1</span>:<span class="var type1" id="S25T5U305">x_sz</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60">60</a></span><span class="line">                <span class="keyword">if</span>(<span class="var type1" id="S12T5U309">viz</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61">61</a></span><span class="line">                [<span class="var type1" id="S38T5U314">e</span>/size(<span class="var type1" id="S13T4U317">E</span>,1) <span class="var type1" id="S39T5U320">j_ix</span>/numel(<span class="mxinfo " id="T3:U216"><span class="var type1" id="S7T5U324">j_min</span>:<span class="var type1" id="S8T5U325">j_max</span></span>) <span class="var type1" id="S29T5U327">k_dims</span>/<span class="var type1" id="S23T5U328">k_sz</span> <span class="var type1" id="S31T5U330">x_dims</span>/<span class="var type1" id="S25T5U331">x_sz</span>]</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62">62</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63">63</a></span><span class="line">                <span class="mxinfo " id="T8:U223"><span class="var type1" id="S32T8U334">x</span> = <span class="mxinfo " id="T8:U225"><span class="mxinfo " id="T8:U226">(<span class="mxinfo " id="T5:U227"><span class="mxinfo " id="T5:U228">2</span>^<span class="var type1" id="S40T5U340">j</span></span>)*<span class="mxinfo " id="T8:U230"><span class="mxinfo " id="T3:U231"><span class="var type1" id="S24T4U343">X</span>(<span class="var type1" id="S31T5U344">x_dims</span>,<span class="mxinfo " id="T7:U234">:</span>)</span>'</span></span> - <span class="mxinfo " id="T8:U235"><span class="mxinfo " id="T3:U236"><span class="var type1" id="S18T4U348">K</span>(<span class="var type1" id="S29T5U349">k_dims</span>,<span class="mxinfo " id="T7:U239">:</span>)</span>'</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64">64</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65">65</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S33T5U353">dimen</span> = <span class="mxinfo " id="T5:U241">1</span>:<span class="var type1" id="S15T5U356">dim</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66">66</a></span><span class="line">                   [<span class="mxinfo " id="T5:U243"><span class="var type1" id="S27T3U361">phis</span>(<span class="var type1" id="S33T5U362">dimen</span>)</span>,<span class="mxinfo " id="T5:U246"><span class="var type1" id="S28T3U364">psis</span>(<span class="var type1" id="S33T5U365">dimen</span>)</span>] = <span class="fcn" id="F247N2:B367">MeyerWavelet</span>(<span class="mxinfo " id="T5:U249"><span class="var type1" id="S32T8U369">x</span>(<span class="var type1" id="S33T5U370">dimen</span>)</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67">67</a></span><span class="line">                   </span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68">68</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69">69</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70">70</a></span><span class="line">                <span class="comment">%[phis,psis] = arrayfun(@(t) MeyerWavelet(t),x);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71">71</a></span><span class="line">                <span class="mxinfo " id="T3:U252"><span class="var type1" id="S27T3U373">phis</span> = <span class="mxinfo " id="T3:U254">(<span class="mxinfo " id="T5:U255"><span class="mxinfo " id="T5:U256">2</span>^<span class="var type1" id="S40T5U378">j</span></span>)*<span class="var type1" id="S27T3U379">phis</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72">72</a></span><span class="line">                <span class="mxinfo " id="T3:U259"><span class="var type1" id="S28T3U382">psis</span> = <span class="mxinfo " id="T3:U261">(<span class="mxinfo " id="T5:U262"><span class="mxinfo " id="T5:U263">2</span>^<span class="var type1" id="S40T5U387">j</span></span>)*<span class="var type1" id="S28T3U388">psis</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73">73</a></span><span class="line">                <span class="comment">%keyboard</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74">74</a></span><span class="line">                <span class="mxinfo " id="T3:U266"><span class="var type1" id="S42T3U391">phi_e</span> = <span class="mxinfo " id="T3:U268">(<span class="mxinfo " id="T3:U269"><span class="mxinfo " id="T5:U270">1</span>-<span class="mxinfo " id="T3:U271"><span class="var type1" id="S13T4U397">E</span>(<span class="var type1" id="S38T5U398">e</span>,<span class="mxinfo " id="T7:U274">:</span>)</span></span>).*<span class="var type1" id="S27T3U400">phis</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75">75</a></span><span class="line">                <span class="mxinfo " id="T3:U276"><span class="var type1" id="S43T3U403">psi_e</span> = <span class="mxinfo " id="T3:U278"><span class="mxinfo " id="T3:U279"><span class="var type1" id="S13T4U406">E</span>(<span class="var type1" id="S38T5U407">e</span>,<span class="mxinfo " id="T7:U282">:</span>)</span>.*<span class="var type1" id="S28T3U409">psis</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76">76</a></span><span class="line">                <span class="mxinfo " id="T3:U284"><span class="var type1" id="S44T3U412">bigPsi_temp</span> = <span class="mxinfo " id="T3:U286"><span class="var type1" id="S42T3U414">phi_e</span>+<span class="var type1" id="S43T3U415">psi_e</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77">77</a></span><span class="line">                <span class="mxinfo " id="T5:U289"><span class="var type1" id="S45T5U418">bigPsi_ejk_x</span> = <span class="mxinfo " id="T5:U291">prod(<span class="var type1" id="S44T3U421">bigPsi_temp</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78">78</a></span><span class="line">                <span class="comment">% check if vectorization preserves locations in this %</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79">79</a></span><span class="line">                <span class="mxinfo " id="T5:U293"><span class="var type1" id="S37T5U424">g_x</span> = <span class="mxinfo " id="T5:U295"><span class="var type1" id="S5T4U426">dist_array_xy</span>(<span class="var type1" id="S31T5U427">x_dims</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80">80</a></span><span class="line">                <span class="mxinfo " id="T5:U298"><span class="var type1" id="S41T5U430">summation_D</span> = <span class="mxinfo " id="T5:U300"><span class="var type1" id="S41T5U432">summation_D</span> + <span class="mxinfo " id="T5:U302"><span class="mxinfo " id="T5:U303">(<span class="mxinfo " id="T5:U304"><span class="var type1" id="S6T5U437">dx</span>^<span class="var type1" id="S15T5U438">dim</span></span>)*<span class="var type1" id="S37T5U439">g_x</span></span>*<span class="var type1" id="S45T5U440">bigPsi_ejk_x</span></span></span></span>; <span class="comment">%check use of dim and dx here</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81">81</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82">82</a></span><span class="line">            <span class="mxinfo " id="T5:U309"><span class="mxinfo " id="T5:U310"><span class="var type1" id="S3T2U444">D_ejk</span>(<span class="var type1" id="S38T5U445">e</span>,<span class="var type1" id="S39T5U446">j_ix</span>,<span class="var type1" id="S29T5U447">k_dims</span>)</span> = <span class="var type1" id="S41T5U448">summation_D</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83">83</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84">84</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85">85</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86">86</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87">87</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88">88</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89">89</a></span><span class="line"></span></span>
</pre>
