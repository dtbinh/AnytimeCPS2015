<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="180,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T328U3">hull</span>, <span class="var type1" id="S3T2U4">area</span>] = graham_scan(<span class="var type1" id="S4T328U7">X</span>,<span class="mxinfo " id="T2:U4"><span class="var type2" id="S5T2V2U8">nr</span></span>,<span class="mxinfo " id="T2:U6"><span class="var type2" id="S6T2V3U9">nc</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="180,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% hull = graham_scan(X,nr,nc)</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="180,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% Computes the convex hull of the data set in X using Graham's scan</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% algorithm. See http://geomalgorithms.com/a10-_hull-1.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,7" id="srcline7">  7</a></span><span class="line"><span class="comment">% X is n-by-2 set of n points in pixel coordinates</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,8" id="srcline8">  8</a></span><span class="line"><span class="comment">% [nr,nc] is the size of the image from which X comes.</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% hull is the convex hull of X, m-by-2, each row is the coordinate of a</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">% hull pixel.</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,11" id="srcline11"> 11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="180,12" id="srcline12"> 12</a></span><span class="line"><span class="mxinfo " id="T2:U8"><span class="var type1" id="S7T2U12">nbpoints</span> = <span class="mxinfo " id="T2:U10">size(<span class="var type1" id="S4T328U15">X</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">% find the lowest, rightmost point</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,14" id="srcline14"> 14</a></span><span class="line"><span class="mxinfo " id="T2:U12"><span class="var type1" id="S9T2U19">m</span> = <span class="mxinfo " id="T2:U14">max(<span class="mxinfo " id="T326:U15"><span class="var type1" id="S4T328U23">X</span>(:,<span class="mxinfo " id="T2:U17">1</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,15" id="srcline15"> 15</a></span><span class="line"><span class="mxinfo " id="T326:U18"><span class="var type1" id="S11T326U28">ff</span> = <span class="mxinfo " id="T326:U20">find(<span class="mxinfo " id="T331:U21"><span class="mxinfo " id="T326:U22"><span class="var type1" id="S4T328U33">X</span>(:,<span class="mxinfo " id="T2:U24">1</span>)</span>==<span class="var type1" id="S9T2U36">m</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,16" id="srcline16"> 16</a></span><span class="line"><span class="mxinfo " id="T328:U26"><span class="var type1" id="S13T328U39">lowestPnts</span> = <span class="mxinfo " id="T328:U28"><span class="var type1" id="S4T328U41">X</span>(<span class="var type1" id="S11T326U42">ff</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,17" id="srcline17"> 17</a></span><span class="line">[<span class="mxinfo " id="T2:U31"><span class="mxinfo " id="T2:U32">~</span></span>,<span class="mxinfo " id="T2:U33"><span class="var type1" id="S14T2U48">ixM</span></span>] = max(<span class="mxinfo " id="T326:U35"><span class="var type1" id="S13T328U52">lowestPnts</span>(:,<span class="mxinfo " id="T2:U37">2</span>)</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="180,18" id="srcline18"> 18</a></span><span class="line"><span class="mxinfo " id="T2:U38"><span class="var type1" id="S15T2U57">fixM</span> = <span class="mxinfo " id="T2:U40"><span class="var type1" id="S11T326U59">ff</span>(<span class="var type1" id="S14T2U60">ixM</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,19" id="srcline19"> 19</a></span><span class="line"><span class="mxinfo " id="T41:U43"><span class="var type1" id="S16T41U63">P0</span> = <span class="mxinfo " id="T41:U45"><span class="var type1" id="S4T328U65">X</span>(<span class="mxinfo " id="T2:U47"><span class="var type1" id="S11T326U67">ff</span>(<span class="var type1" id="S14T2U68">ixM</span>)</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">% m = max(X(:,1));</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">% lowestPts = X(X(:,1)==m,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">% [~,ixM] = max(lowestPts(:,2));</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">% P0 = lowestPts(ixM,:);</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,24" id="srcline24"> 24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="180,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">% Determine the second point in the radially sorted set, and where to start</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">% looping from</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,27" id="srcline27"> 27</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T4:U50"><span class="var type1" id="S15T2U73">fixM</span> == <span class="mxinfo " id="T2:U52">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="180,28" id="srcline28"> 28</a></span><span class="line">    <span class="mxinfo " id="T2:U53"><span class="var type1" id="S17T2U77">next</span> = <span class="mxinfo " id="T2:U55">2</span></span>; <span class="comment">% 2nd point</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,29" id="srcline29"> 29</a></span><span class="line">    <span class="mxinfo " id="T2:U56"><span class="var type1" id="S18T2U81">start</span> = <span class="mxinfo " id="T2:U58">3</span></span>; <span class="comment">% where, therefore, to start looping</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,30" id="srcline30"> 30</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T4:U59"><span class="var type1" id="S15T2U85">fixM</span> == <span class="mxinfo " id="T2:U61">2</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="180,31" id="srcline31"> 31</a></span><span class="line">    <span class="mxinfo " id="T2:U62"><span class="var type1" id="S17T2U89">next</span> =<span class="mxinfo " id="T2:U64">1</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="180,32" id="srcline32"> 32</a></span><span class="line">    <span class="mxinfo " id="T2:U65"><span class="var type1" id="S18T2U93">start</span> = <span class="mxinfo " id="T2:U67">3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,33" id="srcline33"> 33</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,34" id="srcline34"> 34</a></span><span class="line">    <span class="mxinfo " id="T2:U68"><span class="var type1" id="S17T2U98">next</span> = <span class="mxinfo " id="T2:U70">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,35" id="srcline35"> 35</a></span><span class="line">    <span class="mxinfo " id="T2:U71"><span class="var type1" id="S18T2U102">start</span> = <span class="mxinfo " id="T2:U73">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,36" id="srcline36"> 36</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">% sorted_order(i) gives the radial order of the ith point of X</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">% Put the first 2 points in sorted_order.</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,39" id="srcline39"> 39</a></span><span class="line"><span class="mxinfo " id="T333:U74"><span class="var type1" id="S19T333U106">sorted_order</span> = <span class="mxinfo " id="T333:U76">zeros(<span class="mxinfo " id="T2:U77">1</span>,<span class="var type1" id="S7T2U110">nbpoints</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,40" id="srcline40"> 40</a></span><span class="line"><span class="mxinfo " id="T2:U79"><span class="mxinfo " id="T2:U80"><span class="var type1" id="S19T333U114">sorted_order</span>(<span class="mxinfo " id="T2:U82">1</span>)</span>=<span class="var type1" id="S15T2U116">fixM</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,41" id="srcline41"> 41</a></span><span class="line"><span class="mxinfo " id="T2:U84"><span class="mxinfo " id="T2:U85"><span class="var type1" id="S19T333U120">sorted_order</span>(<span class="mxinfo " id="T2:U87">2</span>)</span>= <span class="var type1" id="S17T2U122">next</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,42" id="srcline42"> 42</a></span><span class="line"><span class="mxinfo " id="T2:U89"><span class="var type1" id="S21T2U125">B</span> = <span class="mxinfo " id="T2:U91">2</span></span>; <span class="comment">% as far as we sorted so far</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,43" id="srcline43"> 43</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="180,44" id="srcline44"> 44</a></span><span class="line"><span class="comment">% Sort radially</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,45" id="srcline45"> 45</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S22T2U129">i</span>=<span class="var type1" id="S18T2U131">start</span>:<span class="var type1" id="S7T2U132">nbpoints</span>   </span></span>
<span class="srcline"><span class="lineno"><a href="180,46" id="srcline46"> 46</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T4:U95"><span class="var type1" id="S22T2U136">i</span>==<span class="var type1" id="S15T2U137">fixM</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="180,47" id="srcline47"> 47</a></span><span class="line">        <span class="keyword">continue</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,48" id="srcline48"> 48</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,49" id="srcline49"> 49</a></span><span class="line">    <span class="mxinfo " id="T41:U98"><span class="var type1" id="S23T41U141">P2</span> = <span class="mxinfo " id="T41:U100"><span class="var type1" id="S4T328U143">X</span>(<span class="var type1" id="S22T2U144">i</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,50" id="srcline50"> 50</a></span><span class="line">    <span class="mxinfo " id="T2:U103"><span class="var type1" id="S24T2U148">k</span>=<span class="mxinfo " id="T2:U105">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,51" id="srcline51"> 51</a></span><span class="line">    <span class="mxinfo " id="T41:U106"><span class="var type1" id="S25T41U152">P1</span> = <span class="mxinfo " id="T41:U108"><span class="var type1" id="S4T328U154">X</span>(<span class="mxinfo " id="T2:U110"><span class="var type1" id="S19T333U156">sorted_order</span>(<span class="mxinfo " id="T2:U112"><span class="var type1" id="S24T2U157">k</span></span>)</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,52" id="srcline52"> 52</a></span><span class="line">    <span class="mxinfo " id="T2:U114"><span class="var type1" id="S26T2U161">il</span> = <span class="mxinfo " id="T2:U116"><span class="fcn" id="F1077N15:B163">isLeft</span>(<span class="var type1" id="S16T41U164">P0</span>,<span class="var type1" id="S25T41U165">P1</span>,<span class="var type1" id="S23T41U166">P2</span>,<span class="mxinfo " id="T2:U120"><span class="var type1" id="S5T2U167">nr</span></span>,<span class="var type1" id="S6T2U168">nc</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,53" id="srcline53"> 53</a></span><span class="line">    <span class="keyword">while</span> (<span class="mxinfo " id="T4:U123"><span class="var type1" id="S26T2U173">il</span> &gt; <span class="mxinfo " id="T2:U125">0</span></span> &amp;&amp; <span class="mxinfo " id="T4:U126"><span class="mxinfo " id="T2:U127"><span class="var type1" id="S19T333U177">sorted_order</span>(<span class="mxinfo " id="T2:U129"><span class="var type1" id="S24T2U179">k</span>+<span class="mxinfo " id="T2:U131">1</span></span>)</span>~=<span class="mxinfo " id="T2:U132">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="180,54" id="srcline54"> 54</a></span><span class="line">        <span class="comment">% pick the next point already sorted</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,55" id="srcline55"> 55</a></span><span class="line">        <span class="mxinfo " id="T2:U133"><span class="var type1" id="S24T2U184">k</span>=<span class="mxinfo " id="T2:U135"><span class="var type1" id="S24T2U186">k</span>+<span class="mxinfo " id="T2:U137">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,56" id="srcline56"> 56</a></span><span class="line">        <span class="mxinfo " id="T41:U138"><span class="var type1" id="S25T41U190">P1</span> = <span class="mxinfo " id="T41:U140"><span class="var type1" id="S4T328U192">X</span>(<span class="mxinfo " id="T2:U142"><span class="var type1" id="S19T333U194">sorted_order</span>(<span class="var type1" id="S24T2U195">k</span>)</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,57" id="srcline57"> 57</a></span><span class="line">        <span class="mxinfo " id="T2:U145"><span class="var type1" id="S26T2U199">il</span> = <span class="mxinfo " id="T2:U147"><span class="fcn" id="F1077N15:B201">isLeft</span>(<span class="var type1" id="S16T41U202">P0</span>,<span class="var type1" id="S25T41U203">P1</span>,<span class="var type1" id="S23T41U204">P2</span>,<span class="mxinfo " id="T2:U151"><span class="var type1" id="S5T2U205">nr</span></span>,<span class="var type1" id="S6T2U206">nc</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,58" id="srcline58"> 58</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,59" id="srcline59"> 59</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T4:U154"><span class="var type1" id="S26T2U210">il</span> &lt; <span class="mxinfo " id="T2:U156">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="180,60" id="srcline60"> 60</a></span><span class="line">        <span class="comment">% must shift things to the right to make room for the new point</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,61" id="srcline61"> 61</a></span><span class="line">        <span class="mxinfo " id="T333:U157"><span class="mxinfo " id="T333:U158"><span class="var type1" id="S19T333U215">sorted_order</span>(<span class="mxinfo " id="T2:U160"><span class="var type1" id="S24T2U218">k</span>+<span class="mxinfo " id="T2:U162">1</span></span>:<span class="mxinfo " id="T2:U163"><span class="var type1" id="S21T2U221">B</span>+<span class="mxinfo " id="T2:U165">1</span></span>)</span> = <span class="mxinfo " id="T333:U166"><span class="var type1" id="S19T333U224">sorted_order</span>(<span class="var type1" id="S24T2U226">k</span>:<span class="var type1" id="S21T2U227">B</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,62" id="srcline62"> 62</a></span><span class="line">        <span class="mxinfo " id="T2:U170"><span class="mxinfo " id="T2:U171"><span class="var type1" id="S19T333U231">sorted_order</span>(<span class="var type1" id="S24T2U232">k</span>)</span> = <span class="var type1" id="S22T2U233">i</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="180,63" id="srcline63"> 63</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo " id="T4:U175"><span class="var type1" id="S26T2U236">il</span> == <span class="mxinfo " id="T2:U177">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="180,64" id="srcline64"> 64</a></span><span class="line">        <span class="mxinfo " id="T41:U178"><span class="var type1" id="S28T41U240">d2P0</span> = <span class="mxinfo " id="T41:U180">[<span class="mxinfo " id="T2:U181">norm(<span class="mxinfo " id="T41:U182"><span class="var type1" id="S16T41U246">P0</span>-<span class="var type1" id="S25T41U247">P1</span></span>)</span>, <span class="mxinfo " id="T2:U185">norm(<span class="mxinfo " id="T41:U186"><span class="var type1" id="S16T41U251">P0</span>-<span class="var type1" id="S23T41U252">P2</span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,65" id="srcline65"> 65</a></span><span class="line">        [<span class="mxinfo " id="T2:U189"><span class="mxinfo " id="T2:U190">~</span></span>,<span class="mxinfo " id="T2:U191"><span class="var type1" id="S30T2U257">md</span></span>]=max(<span class="var type1" id="S28T41U260">d2P0</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="180,66" id="srcline66"> 66</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T4:U194"><span class="var type1" id="S30T2U264">md</span>==<span class="mxinfo " id="T2:U196">2</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="180,67" id="srcline67"> 67</a></span><span class="line">            <span class="mxinfo " id="T2:U197"><span class="mxinfo " id="T2:U198"><span class="var type1" id="S19T333U269">sorted_order</span>(<span class="var type1" id="S24T2U270">k</span>)</span>=<span class="var type1" id="S22T2U271">i</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,68" id="srcline68"> 68</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,69" id="srcline69"> 69</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,70" id="srcline70"> 70</a></span><span class="line">        <span class="comment">% to the left of everything seen so far</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,71" id="srcline71"> 71</a></span><span class="line">        <span class="mxinfo " id="T2:U202"><span class="mxinfo " id="T2:U203"><span class="var type1" id="S19T333U276">sorted_order</span>(<span class="mxinfo " id="T2:U205"><span class="var type1" id="S24T2U278">k</span>+<span class="mxinfo " id="T2:U207">1</span></span>)</span> = <span class="var type1" id="S22T2U280">i</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,72" id="srcline72"> 72</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,73" id="srcline73"> 73</a></span><span class="line">    <span class="mxinfo " id="T2:U209"><span class="var type1" id="S21T2U283">B</span> = <span class="mxinfo " id="T2:U211"><span class="var type1" id="S21T2U285">B</span>+<span class="mxinfo " id="T2:U213">1</span></span></span>;                </span></span>
<span class="srcline"><span class="lineno"><a href="180,74" id="srcline74"> 74</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,75" id="srcline75"> 75</a></span><span class="line"><span class="comment">% the cases where il=0 throw out some points so there may be 0 entries in</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">% sorted_order. Here we get rid of them.</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,77" id="srcline77"> 77</a></span><span class="line"><span class="mxinfo " id="T333:U214"><span class="var type1" id="S19T333U289">sorted_order</span> = <span class="mxinfo " id="T333:U216"><span class="var type1" id="S19T333U291">sorted_order</span>(<span class="mxinfo " id="T334:U218"><span class="var type1" id="S19T333U293">sorted_order</span>~=<span class="mxinfo " id="T2:U220">0</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,78" id="srcline78"> 78</a></span><span class="line"><span class="mxinfo " id="T2:U221"><span class="var type1" id="S31T2U297">nchpnts</span> = <span class="mxinfo " id="T2:U223">length(<span class="var type1" id="S19T333U300">sorted_order</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,79" id="srcline79"> 79</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="180,80" id="srcline80"> 80</a></span><span class="line"><span class="comment">% Get convex hull</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,81" id="srcline81"> 81</a></span><span class="line"><span class="mxinfo " id="T328:U225"><span class="var type1" id="S33T328U303">stack</span> = <span class="mxinfo " id="T328:U227">-<span class="mxinfo " id="T328:U228">ones(<span class="var type1" id="S31T2U307">nchpnts</span>,<span class="mxinfo " id="T2:U230">2</span>)</span></span></span>; <span class="comment">% pre-allocate for speed</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,82" id="srcline82"> 82</a></span><span class="line"><span class="mxinfo " id="T308:U231"><span class="mxinfo " id="T308:U232"><span class="var type1" id="S33T328U312">stack</span>(<span class="mxinfo " id="T41:U234"><span class="mxinfo " id="T2:U235">1</span>:<span class="mxinfo " id="T2:U236">2</span></span>,:)</span> = <span class="mxinfo " id="T308:U237"><span class="var type1" id="S4T328U318">X</span>(<span class="mxinfo " id="T41:U239"><span class="var type1" id="S19T333U320">sorted_order</span>(<span class="mxinfo " id="T41:U241"><span class="mxinfo " id="T2:U242">1</span>:<span class="mxinfo " id="T2:U243">2</span></span>)</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,83" id="srcline83"> 83</a></span><span class="line"><span class="mxinfo " id="T2:U244"><span class="var type1" id="S35T2U327">s</span> = <span class="mxinfo " id="T2:U246">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,84" id="srcline84"> 84</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S24T2U331">k</span>=<span class="mxinfo " id="T2:U248">3</span>:<span class="var type1" id="S31T2U334">nchpnts</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,85" id="srcline85"> 85</a></span><span class="line"><span class="comment">%     s = size(stack,1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,86" id="srcline86"> 86</a></span><span class="line">    <span class="mxinfo " id="T41:U250"><span class="var type1" id="S36T41U337">Pk</span> = <span class="mxinfo " id="T41:U252"><span class="var type1" id="S4T328U339">X</span>(<span class="mxinfo " id="T2:U254"><span class="var type1" id="S19T333U341">sorted_order</span>(<span class="var type1" id="S24T2U342">k</span>)</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,87" id="srcline87"> 87</a></span><span class="line">    <span class="mxinfo " id="T2:U257"><span class="var type1" id="S26T2U346">il</span> = <span class="mxinfo " id="T2:U259"><span class="fcn" id="F1077N15:B348">isLeft</span>(<span class="mxinfo " id="T41:U260"><span class="var type1" id="S4T328U350">X</span>(<span class="mxinfo " id="T2:U262"><span class="var type1" id="S19T333U352">sorted_order</span>(<span class="mxinfo " id="T2:U264"><span class="var type1" id="S35T2U354">s</span>-<span class="mxinfo " id="T2:U266">1</span></span>)</span>,:)</span>,<span class="mxinfo " id="T41:U267"><span class="var type1" id="S4T328U358">X</span>(<span class="mxinfo " id="T2:U269"><span class="var type1" id="S19T333U360">sorted_order</span>(<span class="var type1" id="S35T2U361">s</span>)</span>,:)</span>,<span class="var type1" id="S36T41U363">Pk</span>,<span class="mxinfo " id="T2:U273"><span class="var type1" id="S5T2U364">nr</span></span>,<span class="var type1" id="S6T2U365">nc</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,88" id="srcline88"> 88</a></span><span class="line">    <span class="keyword">while</span> <span class="mxinfo " id="T4:U276"><span class="var type1" id="S26T2U369">il</span> &lt;= <span class="mxinfo " id="T2:U278">0</span></span> &amp;&amp; <span class="mxinfo " id="T4:U279"><span class="mxinfo " id="T2:U280">size(<span class="var type1" id="S33T328U374">stack</span>,1)</span> &gt; <span class="mxinfo " id="T2:U282">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="180,89" id="srcline89"> 89</a></span><span class="line">        <span class="comment">% pop </span></span></span>
<span class="srcline"><span class="lineno"><a href="180,90" id="srcline90"> 90</a></span><span class="line">        <span class="mxinfo " id="T41:U283"><span class="mxinfo " id="T41:U284"><span class="var type1" id="S33T328U380">stack</span>(<span class="mxinfo " id="T2:U286">end</span>,:)</span> = <span class="mxinfo " id="T41:U287">[<span class="mxinfo " id="T2:U288">-<span class="mxinfo " id="T2:U289">1</span></span> <span class="mxinfo " id="T2:U290">-<span class="mxinfo " id="T2:U291">1</span></span>]</span></span>; <span class="mxinfo " id="T2:U292"><span class="var type1" id="S35T2U392">s</span> = <span class="mxinfo " id="T2:U294"><span class="var type1" id="S35T2U394">s</span>-<span class="mxinfo " id="T2:U296">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,91" id="srcline91"> 91</a></span><span class="line">        <span class="mxinfo " id="T2:U297"><span class="var type1" id="S26T2U398">il</span> = <span class="mxinfo " id="T2:U299"><span class="fcn" id="F1077N15:B400">isLeft</span>(<span class="mxinfo " id="T41:U300"><span class="var type1" id="S4T328U402">X</span>(<span class="mxinfo " id="T2:U302"><span class="var type1" id="S19T333U404">sorted_order</span>(<span class="mxinfo " id="T2:U304"><span class="var type1" id="S35T2U406">s</span>-<span class="mxinfo " id="T2:U306">1</span></span>)</span>,:)</span>,<span class="mxinfo " id="T41:U307"><span class="var type1" id="S4T328U410">X</span>(<span class="mxinfo " id="T2:U309"><span class="var type1" id="S19T333U412">sorted_order</span>(<span class="var type1" id="S35T2U413">s</span>)</span>,:)</span>,<span class="var type1" id="S36T41U415">Pk</span>,<span class="mxinfo " id="T2:U313"><span class="var type1" id="S5T2U416">nr</span></span>,<span class="var type1" id="S6T2U417">nc</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,92" id="srcline92"> 92</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,93" id="srcline93"> 93</a></span><span class="line">    <span class="mxinfo " id="T41:U316"><span class="mxinfo " id="T41:U317"><span class="var type1" id="S33T328U421">stack</span>(<span class="mxinfo " id="T2:U319"><span class="var type1" id="S35T2U423">s</span>+<span class="mxinfo " id="T2:U321">1</span></span>,:)</span> = <span class="var type1" id="S36T41U426">Pk</span></span>; <span class="mxinfo " id="T2:U323"><span class="var type1" id="S35T2U429">s</span> = <span class="mxinfo " id="T2:U325"><span class="var type1" id="S35T2U431">s</span>+<span class="mxinfo " id="T2:U327">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,94" id="srcline94"> 94</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,95" id="srcline95"> 95</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="180,96" id="srcline96"> 96</a></span><span class="line"><span class="mxinfo " id="T328:U328"><span class="var type1" id="S2T328U435">hull</span> = <span class="mxinfo " id="T328:U330"><span class="var type1" id="S33T328U437">stack</span>(<span class="mxinfo " id="T4:U332"><span class="mxinfo " id="T2:U333">1</span>:<span class="var type1" id="S35T2U440">s</span></span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="180,97" id="srcline97"> 97</a></span><span class="line"><span class="mxinfo " id="T2:U335"><span class="var type1" id="S3T2U444">area</span> = <span class="mxinfo " id="T2:U337">polyarea(<span class="mxinfo " id="T326:U338"><span class="var type1" id="S2T328U448">hull</span>(:,<span class="mxinfo " id="T2:U340">1</span>)</span>,<span class="mxinfo " id="T326:U341"><span class="var type1" id="S2T328U452">hull</span>(:,<span class="mxinfo " id="T2:U343">2</span>)</span>)</span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="180,98" id="srcline98"> 98</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="180,99" id="srcline99"> 99</a></span><span class="line"></span></span>
</pre>
